import{r as x,j as e,A as B,M as U}from"./index-BinNrs6B.js";import{a as G,T as z}from"./Controls-Dmgv-qPu.js";import{O as i,t as Q}from"./optics-BJr8qzqd.js";import{M as Y}from"./maximize-2-Btv_Vm56.js";import{A as H}from"./activity-BGnSObBm.js";import{M as q}from"./monitor-play-DrmSFUS0.js";import{S as C}from"./sparkles-JNI-gCFx.js";import{E as V}from"./eye-Dcth9ZIn.js";import{T as I}from"./triangle-alert-DkNT8UA7.js";import{C as J}from"./calculator-twGgHS_P.js";import{L as K}from"./layers-BQryiife.js";const S={ZOOM_STD:{name:"24-70mm GM II (索尼大法好)",nickname:"明日之镜",type:"Zoom",minF:24,maxF:70,minAp:2.8,maxAp:22,elements:"20 elements (堆料狂魔)",weight:"695g (健身器材轻量化)",lengthFactor:1,minFocus:210,meme:"索尼罪大滔天，百姓无不怀念。买G大师不仅是买镜头，更是充值信仰。"},PRIME_FAST:{name:"50mm f/1.2 L (感动牌牙膏厂)",nickname:"人像镜皇",type:"Prime",minF:50,maxF:50,minAp:1.2,maxAp:16,elements:"14 elements (挤爆牙膏)",weight:"998g (练臂力)",lengthFactor:.8,minFocus:400,meme:'光圈全开锐度爆表，焦外如奶油般化开，这就是"德味"（虽然是日产）。'},ZOOM_TELE:{name:"70-200mm (老法师之剑)",nickname:"公园打鸟神器",type:"Zoom",minF:70,maxF:200,minAp:4,maxAp:32,elements:"21 elements",weight:"1200g",lengthFactor:1.4,minFocus:1e3,meme:"公园大爷的最爱。荷花、翠鸟、还有漫展。只要够长，不仅能拍鸟，还能用来防身。"},MACRO_100:{name:"100mm F2.8 GM (2025新品)",nickname:"百微 GM II",type:"Prime",minF:100,maxF:100,minAp:2.8,maxAp:32,elements:"16 elements (双浮动对焦)",weight:"650g",lengthFactor:1.2,minFocus:240,meme:"1.4倍放大倍率，数毛党的终极兵器。连螨虫的腿毛都能拍清楚，密集恐惧症慎入。"}},pe=({initialTab:ee})=>{const[j,O]=x.useState("ZOOM_STD"),[d,A]=x.useState(.5),[n,v]=x.useState(5.6),[M,P]=x.useState(!0),[o,$]=x.useState(1200),[g,R]=x.useState(!1),s=S[j];x.useEffect(()=>{n<s.minAp&&v(s.minAp),n>s.maxAp&&v(s.maxAp),s.type==="Prime"&&A(0),o<s.minFocus&&$(s.minFocus)},[j]);const y=s.minF+d*(s.maxF-s.minF),b=750,m=200-(s.lengthFactor-1)*50,E=s.type==="Prime"?0:100,w=m+50+d*E,u=m+250+d*(E*.5),F=u-20,T=(1-Math.min(o,5e3)/5e3)*(.15*(600/Math.max(o,600))),L=1+(g?T*.05:T),k=x.useMemo(()=>j!=="ZOOM_STD"?[{x:m,f:120*s.lengthFactor,h:45,name:"前玉 (G1)",type:"STD"},{x:w,f:-60,h:35,name:"变焦组",type:"STD"},{x:F,f:1/0,h:50/n*10,name:"光圈",type:"APERTURE"},{x:u,f:110*s.lengthFactor,h:40,name:"对焦组",type:"STD"}]:[{x:m,f:120*s.lengthFactor,h:45,name:"XA 前玉",type:"XA"},{x:w,f:-60,h:35,name:"ED 变焦组",type:"ED"},{x:F,f:1/0,h:50/n*10,name:"光圈",type:"APERTURE"},{x:u,f:110*s.lengthFactor,h:40,name:"XA 对焦组",type:"XA"}],[w,u,F,n,s.lengthFactor,m,j]),h=b-o,X=x.useMemo(()=>{const t=[],l=[{y:i,color:"#10b981"},{y:i-40,color:"#3b82f6"},{y:i+40,color:"#ef4444"}];for(const a of l){const r=[-.15,-.07,0,.07,.15];for(const c of r){const N=m-h,p=i-a.y,Z=Math.atan2(p,N),_=1e3/(o*s.lengthFactor),D=Q({x:h,y:a.y},Z+c*_,k,b);D.blocked||t.push({path:D.path,color:a.color})}}return t},[h,k,o,s.lengthFactor,m]),W=x.useMemo(()=>{let a=1;n<2.8&&(a-=(2.8-n)*.15),n>16&&(a-=(n-16)*.05),s.type==="Zoom"&&(a-=Math.abs(d-.5)*.1),a=Math.max(.3,a);const r=80-80*a,c=80-80*(a*.5);return`M 0,${r} Q ${180/2},${r} 180,${c}`},[n,d,s.type]),f=(()=>{const l=y,a=n,r=o,c=l*l/(a*.03)+l,N=c*r/(c+(r-l)),p=c*r/(c-(r-l));return{near:N,far:p>0?p:1/0,depth:p>0?p-N:1/0}})();return e.jsxs("div",{className:"flex flex-col lg:flex-row h-full",children:[e.jsxs("div",{className:"flex-1 bg-slate-950 relative overflow-hidden border-b lg:border-r border-slate-800",children:[e.jsxs("div",{className:"absolute top-4 left-4 z-10 font-mono text-xs text-cyan-500 space-y-2 pointer-events-none",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Y,{size:14}),e.jsxs("span",{children:["EFL: ",y.toFixed(1),"mm"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(B,{size:14}),e.jsxs("span",{children:["IRIS: f/",n.toFixed(1)]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(H,{size:14}),e.jsxs("span",{children:["MTF: ",(100-(n>8?(n-8)*5:(4-n)*8)).toFixed(0),"%"]})]}),g&&e.jsxs("div",{className:"flex items-center gap-2 text-purple-400 animate-pulse",children:[e.jsx(q,{size:14}),e.jsx("span",{children:"BREATHING COMP: ON"})]})]}),e.jsx("div",{className:"absolute bottom-4 right-4 z-10 flex flex-col gap-1 items-end pointer-events-none",children:e.jsxs("div",{className:"flex gap-4 text-[10px] text-slate-500 bg-black/50 p-2 rounded border border-slate-800",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"w-3 h-3 border border-orange-500 bg-[url(#pattern-xa)]"})," XA 极值非球面"]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"w-3 h-3 border border-green-500 bg-[url(#pattern-ed)]"})," ED 低色散"]})]})}),e.jsxs("svg",{className:"w-full h-full",viewBox:"0 0 800 500",children:[e.jsxs("defs",{children:[e.jsx("pattern",{id:"pattern-xa",patternUnits:"userSpaceOnUse",width:"6",height:"6",patternTransform:"rotate(45)",children:e.jsx("line",{x1:"0",y1:"0",x2:"0",y2:"6",stroke:"#ea580c",strokeWidth:"2"})}),e.jsx("pattern",{id:"pattern-ed",patternUnits:"userSpaceOnUse",width:"6",height:"6",children:e.jsx("line",{x1:"0",y1:"0",x2:"6",y2:"0",stroke:"#16a34a",strokeWidth:"2"})})]}),e.jsx("line",{x1:"0",y1:i,x2:"800",y2:i,stroke:"#334155",strokeDasharray:"4,4"}),e.jsxs("g",{transform:`translate(${b}, ${i})`,children:[e.jsx("line",{x1:"0",y1:"-60",x2:"0",y2:"60",stroke:"#94a3b8",strokeWidth:"4"}),e.jsx("text",{x:"10",y:"0",fill:"#64748b",fontSize:"10",style:{writingMode:"vertical-rl"},children:"CMOS"})]}),k.map((t,l)=>t.type==="APERTURE"?e.jsxs("g",{transform:`translate(${t.x}, ${i})`,children:[e.jsx("line",{x1:"0",y1:-t.h-20,x2:"0",y2:-t.h,stroke:"#eab308",strokeWidth:"3"}),e.jsx("line",{x1:"0",y1:t.h+20,x2:"0",y2:t.h,stroke:"#eab308",strokeWidth:"3"})]},l):e.jsxs("g",{transform:`translate(${t.x}, ${i})`,children:[e.jsx("path",{d:t.f>0?`M-5,-${t.h} Q15,0 -5,${t.h} L5,${t.h} Q-15,0 5,-${t.h} Z`:`M-5,-${t.h} Q-15,0 -5,${t.h} L5,${t.h} Q15,0 5,-${t.h} Z`,fill:t.type==="XA"?"url(#pattern-xa)":t.type==="ED"?"url(#pattern-ed)":"rgba(34, 211, 238, 0.15)",stroke:t.type==="XA"?"#ea580c":t.type==="ED"?"#16a34a":t.f>0?"#22d3ee":"#a8a29e",strokeWidth:"1.5"}),e.jsx("text",{x:"-10",y:-t.h-10,fill:t.type==="XA"?"#ea580c":t.type==="ED"?"#16a34a":"#475569",fontSize:"9",fontWeight:"bold",children:t.name}),e.jsx("path",{d:"M-2,-10 L2,0",stroke:"white",strokeWidth:"1",opacity:"0.3"})]},l)),M&&X.map((t,l)=>e.jsx("polyline",{points:t.path.map(a=>`${a.x},${a.y}`).join(" "),fill:"none",stroke:t.color,strokeWidth:"1",opacity:"0.4"},l)),h>-50&&e.jsxs("g",{transform:`translate(${h}, ${i})`,children:[e.jsx("line",{x1:"0",y1:"-40",x2:"0",y2:"40",stroke:"white",strokeWidth:"2"}),e.jsx("text",{x:"-10",y:"-50",fill:"white",fontSize:"10",children:"Subject"})]}),e.jsx("g",{className:"transition-opacity duration-300",children:(()=>{const t=i+120,l=h<20,a=l?20:h,r=b,c=Math.min(Math.max((a+r)/2,100),700);return e.jsxs("g",{children:[e.jsx("line",{x1:a,y1:t,x2:r,y2:t,stroke:"#10b981",strokeWidth:"1"}),l&&e.jsx("path",{d:`M${a},${t} L${a+10},${t-4} L${a+10},${t+4} Z`,fill:"#10b981"}),e.jsx("line",{x1:r,y1:t-5,x2:r,y2:t+5,stroke:"#10b981",strokeWidth:"2"}),!l&&e.jsx("line",{x1:a,y1:t-5,x2:a,y2:t+5,stroke:"#10b981",strokeWidth:"2"}),e.jsx("line",{x1:r,y1:i+70,x2:r,y2:t,stroke:"#10b981",strokeDasharray:"2,2",opacity:"0.3"}),e.jsx("rect",{x:c-40,y:t-10,width:"80",height:"20",fill:"#020617",rx:"4",stroke:"#10b981",strokeWidth:"1"}),e.jsx("text",{x:c,y:t+4,fill:"#10b981",fontSize:"11",textAnchor:"middle",fontFamily:"monospace",children:o<1e4?`${(o/1e3).toFixed(2)}m`:"∞"})]})})()})]})]}),e.jsxs("div",{className:"w-full lg:w-80 bg-slate-900 border-l border-slate-800 flex flex-col overflow-y-auto select-none",children:[e.jsxs("div",{className:"p-6 pb-2 border-b border-slate-800",children:[e.jsxs("h3",{className:"text-lg font-bold text-slate-100 flex items-center gap-2",children:[e.jsx(U,{className:"text-cyan-400",size:20}),"实验室 (Lab)"]}),e.jsx("div",{className:"mt-4",children:e.jsx(G,{label:"镜头预设 (Lens Preset)",value:j,options:Object.keys(S).map(t=>({label:S[t].name,value:t})),onChange:t=>O(t)})}),e.jsxs("div",{className:"mt-4 bg-gradient-to-r from-slate-800 to-slate-900 border border-slate-700 p-3 rounded-lg relative overflow-hidden group",children:[e.jsx("div",{className:"absolute -right-4 -top-4 text-slate-700 opacity-20 transform rotate-12",children:e.jsx(C,{size:80})}),e.jsxs("div",{className:"text-[10px] font-bold text-cyan-400 mb-1 flex items-center gap-1",children:[e.jsx(C,{size:10})," 圈内黑话 (Community Insight)"]}),e.jsxs("div",{className:"text-[10px] text-slate-300 leading-relaxed italic",children:['"',s.meme,'"']})]})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"bg-black rounded-lg border-2 border-slate-700 p-2 relative overflow-hidden aspect-video flex items-center justify-center group shadow-lg",children:[e.jsxs("div",{className:"absolute top-2 left-2 text-[10px] text-green-500 font-mono z-10 flex items-center gap-1",children:[e.jsx(V,{size:10})," REC [STANDBY]"]}),e.jsxs("div",{className:"absolute bottom-2 right-2 text-[10px] text-white font-mono z-10",children:[y.toFixed(0),"mm"]}),e.jsxs("div",{className:"w-full h-full relative transition-transform duration-300 ease-out",style:{transform:`scale(${1+d*1.5}) scale(${L})`,backgroundImage:"linear-gradient(rgba(255,255,255,0.1) 1px, transparent 1px), linear-gradient(90deg, rgba(255,255,255,0.1) 1px, transparent 1px)",backgroundSize:"20px 20px"},children:[e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("div",{className:"w-16 h-16 border border-white/50 rounded-full flex items-center justify-center",children:e.jsx("div",{className:"w-1 h-1 bg-red-500 rounded-full animate-pulse"})})}),e.jsx("div",{className:"absolute top-1/4 left-1/4 w-8 h-20 bg-slate-700/50"}),e.jsx("div",{className:"absolute bottom-1/4 right-1/4 w-12 h-12 bg-slate-600/50 rounded-full"})]}),e.jsx("div",{className:"absolute inset-0 pointer-events-none bg-black transition-opacity duration-300",style:{opacity:.8-(22-n)/22*.8}}),e.jsx("div",{className:"absolute inset-4 border border-white/20 pointer-events-none"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-xs mb-2",children:[e.jsx("span",{className:"text-slate-400",children:"变焦 (Zoom)"}),e.jsxs("span",{className:"text-cyan-400 font-mono",children:[y.toFixed(0),"mm"]})]}),e.jsx("input",{type:"range",min:"0",max:"1",step:"0.01",value:d,disabled:s.type==="Prime",onChange:t=>A(parseFloat(t.target.value)),className:`w-full h-1 rounded appearance-none ${s.type==="Prime"?"bg-slate-800 cursor-not-allowed":"bg-slate-700 accent-cyan-500"}`})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-xs mb-2",children:[e.jsx("span",{className:"text-slate-400",children:"对焦 (Distance)"}),e.jsxs("span",{className:"text-emerald-400 font-mono",children:[(o/1e3).toFixed(2),"m"]})]}),e.jsx("input",{type:"range",min:s.minFocus,max:"5000",step:"10",value:o,onChange:t=>$(parseFloat(t.target.value)),className:"w-full accent-emerald-500 h-1 bg-slate-700 appearance-none rounded dir-rtl"}),e.jsxs("div",{className:"mt-4",children:[e.jsx(z,{label:"呼吸补偿 (Breathing Comp.)",checked:g,onChange:R}),e.jsx("div",{className:"text-[10px] text-slate-500 leading-tight",children:g?"启用补偿：视角锁定。通过裁切画面边缘，抵消对焦时的物理焦距变化。":"原生光学：视角随对焦距离改变（呼吸效应）。"})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-xs mb-2",children:[e.jsx("span",{className:"text-slate-400",children:"光圈 (Aperture)"}),e.jsxs("span",{className:"text-yellow-500 font-mono",children:["f/",n.toFixed(1)]})]}),e.jsx("input",{type:"range",min:s.minAp,max:s.maxAp,step:"0.1",value:n,onChange:t=>v(parseFloat(t.target.value)),className:"w-full accent-yellow-500 h-1 bg-slate-700 appearance-none rounded"}),e.jsxs("div",{className:"flex justify-between h-4 mt-1",children:[n<2&&e.jsxs("span",{className:"text-[10px] text-pink-400 flex items-center gap-1",children:[e.jsx(I,{size:8})," 刀锐奶化 (Creamy)"]}),n>16&&e.jsxs("span",{className:"text-[10px] text-orange-400 flex items-center gap-1 ml-auto",children:[e.jsx(I,{size:8})," 衍射画质崩坏"]})]})]})]}),e.jsxs("div",{className:"bg-slate-800 rounded p-3 border border-slate-700",children:[e.jsxs("h4",{className:"text-xs font-bold text-slate-300 flex items-center gap-2 mb-2",children:[e.jsx(J,{size:12,className:"text-emerald-400"})," 景深计算器 (DoF Calc)"]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center",children:[e.jsxs("div",{className:"bg-slate-900 p-1 rounded",children:[e.jsx("div",{className:"text-[9px] text-slate-500",children:"前界限"}),e.jsxs("div",{className:"text-[10px] font-mono text-emerald-300",children:[(f.near/1e3).toFixed(2),"m"]})]}),e.jsxs("div",{className:"bg-slate-900 p-1 rounded",children:[e.jsx("div",{className:"text-[9px] text-slate-500",children:"后界限"}),e.jsx("div",{className:"text-[10px] font-mono text-emerald-300",children:f.far===1/0?"∞":(f.far/1e3).toFixed(2)+"m"})]}),e.jsxs("div",{className:"bg-slate-900 p-1 rounded border border-emerald-900/50",children:[e.jsx("div",{className:"text-[9px] text-slate-500",children:"总景深"}),e.jsx("div",{className:"text-[10px] font-mono text-emerald-400 font-bold",children:f.depth===1/0?"∞":(f.depth/1e3).toFixed(2)+"m"})]})]})]}),e.jsxs("div",{className:"bg-slate-800 rounded p-3 border border-slate-700",children:[e.jsxs("h4",{className:"text-xs font-bold text-slate-300 flex items-center gap-2 mb-2",children:[e.jsx(K,{size:12,className:"text-blue-400"})," 镜头参数 (Specs)"]}),e.jsxs("ul",{className:"text-[10px] space-y-1 text-slate-400",children:[e.jsxs("li",{className:"flex justify-between",children:[e.jsx("span",{children:"别名:"})," ",e.jsx("span",{className:"text-cyan-200",children:s.nickname})]}),e.jsxs("li",{className:"flex justify-between",children:[e.jsx("span",{children:"结构:"})," ",e.jsx("span",{className:"text-slate-200",children:s.elements})]}),e.jsxs("li",{className:"flex justify-between",children:[e.jsx("span",{children:"重量:"})," ",e.jsx("span",{className:"text-slate-200",children:s.weight})]})]})]}),e.jsxs("div",{className:"bg-slate-800 rounded-lg p-3 border border-slate-700",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-xs font-bold text-slate-300",children:"MTF 模拟 (玄学曲线)"}),e.jsx("span",{className:"text-[9px] text-cyan-400",children:"@ 30 lp/mm"})]}),e.jsx("div",{className:"relative h-12 w-full bg-slate-900 border border-slate-700/50 rounded overflow-hidden",children:e.jsxs("svg",{className:"w-full h-full",viewBox:"0 0 180 80",preserveAspectRatio:"none",children:[e.jsx("path",{d:W,stroke:"#22d3ee",strokeWidth:"2",fill:"none"}),e.jsx("line",{x1:"0",y1:"20",x2:"180",y2:"20",stroke:"#334155",strokeDasharray:"2,2"}),e.jsx("line",{x1:"0",y1:"40",x2:"180",y2:"40",stroke:"#334155",strokeDasharray:"2,2"}),e.jsx("line",{x1:"0",y1:"60",x2:"180",y2:"60",stroke:"#334155",strokeDasharray:"2,2"})]})})]}),e.jsx(z,{label:"显示光路 (Ray Tracing)",checked:M,onChange:P})]})]})]})};export{pe as ZoomSystemView};
